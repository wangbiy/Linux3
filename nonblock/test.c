/*
               #########                       
               #########                       
              ############                     
              #############                    
             ##  ###########                   
            ###  ###### #####                  
            ### #######   ####                 
           ###  ########## ####                
          ####  ########### ####               
        ####   ###########  #####              
       #####   ### ########   #####            
      #####   ###   ########   ######          
     ######   ###  ###########   ######        
    ######   #### ##############  ######       
   #######  #####################  ######      
   #######  ######################  ######     
  #######  ###### #################  ######    
  #######  ###### ###### #########   ######    
  #######    ##  ######   ######     ######    
  #######        ######    #####     #####     
   ######        #####     #####     ####      
    #####        ####      #####     ###       
     #####       ###        ###      #         
       ###       ###        ###                
        ##       ###        ###                
_________#_______####_______####______________ 
               我们的未来没有BUG               
* ==============================================================================
* FileName:test.c
* Author  :Daisy
* Created :2019-11-25
* Purpose :
* ==============================================================================
*/
#include<stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <fcntl.h>
#include <errno.h>
int set_non_block(int fd)
{
    int f1=fcntl(fd,F_GETFL);
    if(f1<0)
    {
        perror("fcntl");
        exit(1);
    }
    fcntl(fd,F_SETFL,f1 | O_NONBLOCK);
}
int main()
{
    char buf[1024];
    set_non_block(0);//设置为非阻塞
    while(1)
    {
        ssize_t s=read(0,buf,sizeof(buf)-1);
        if(s>0)
        {
            buf[s]=0;
            printf("%s\n",buf);
        }
        else if(s==0)
        {
            printf("read end!\n");
            break;
        }
        else
        {
            printf("do other thing...%d, %d\n",s,errno);
            sleep(1);
        }
        sleep(1);
    }
}
